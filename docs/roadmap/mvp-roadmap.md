# XRouter MVP Roadmap

## Обзор MVP
XRouter MVP представляет собой базовую реализацию роутера для российских LLM моделей с фокусом на:
- OAuth авторизацию и управление ключами
- Интеграцию с GigaChat и YandexGPT
- Базовый роутинг
- API Gateway

## Технический стек MVP
- **Backend**: Python 3.11+
- **Framework**: FastAPI
- **Database**: PostgreSQL
- **Cache**: Redis (для rate limiting)
- **Authentication**: OAuth 2.0 + API Keys
- **Testing**: pytest
- **Documentation**: OpenAPI/Swagger

## Фазы разработки MVP

### Фаза 1: Авторизация (2 недели)
- [ ] OAuth 2.0 сервис
  - [ ] PKCE flow
  - [ ] JWT токены (1 год)
  - [ ] Отзыв токенов
  - [ ] Тесты авторизации

- [ ] Управление ключами
  - [ ] UI для управления
  - [ ] Создание/отзыв ключей
  - [ ] Rate limiting
  - [ ] Мониторинг использования

### Фаза 2: Core Функциональность (2 недели)
- [ ] API Gateway
  - [ ] Базовая структура эндпоинтов
  - [ ] Валидация запросов
  - [ ] Обработка ошибок
  - [ ] Логирование

- [ ] Rate Limiting
  - [ ] Redis интеграция
  - [ ] Квоты по ключам
  - [ ] Мониторинг лимитов
  - [ ] Алерты

### Фаза 3: Провайдеры (2 недели)
- [ ] GigaChat Provider
  - [ ] Клиент для GigaChat API
  - [ ] Обработка аутентификации
  - [ ] Маппинг запросов/ответов
  - [ ] Обработка ошибок

- [ ] YandexGPT Provider
  - [ ] Клиент для YandexGPT
  - [ ] Версионность (:latest, :rc)
  - [ ] Маппинг моделей
  - [ ] Обработка ошибок

### Фаза 4: Роутинг и тестирование (2 недели)
- [ ] Базовый роутинг
  - [ ] Логика маршрутизации
  - [ ] Обработка ошибок
  - [ ] Fallback механизмы
  - [ ] Метрики

- [ ] Тестирование
  - [ ] Unit тесты
  - [ ] Интеграционные тесты
  - [ ] Нагрузочные тесты
  - [ ] E2E тесты

## Критерии успеха MVP

### Функциональные требования
1. Авторизация и ключи
   - Работающий OAuth с PKCE
   - Управление API ключами
   - Rate limiting
   - Отзыв токенов

2. Интеграция с провайдерами
   - GigaChat работает
   - YandexGPT с версиями
   - Обработка ошибок
   - Fallback механизмы

3. API Gateway
   - OpenAI-совместимый API
   - Валидация запросов
   - Мониторинг
   - Документация

### Нефункциональные требования
1. Производительность
   - Latency < 500ms (без учета времени ответа провайдера)
   - Успешная обработка 100 req/s
   - Memory usage < 500MB

2. Надежность
   - Error rate < 1%
   - Успешное восстановление после ошибок
   - Корректная обработка таймаутов

3. Безопасность
   - Безопасное хранение ключей
   - Валидация токенов
   - Правильное логирование

## План развития после MVP

### Go Migration
- Перенос на Go
- Kubernetes deployment
- HA PostgreSQL
- Redis cluster

### Production Features
- Улучшенный мониторинг
- Расширенная аналитика
- SLA мониторинг
- Биллинг

## Риски MVP

### Технические риски
1. Производительность Python
   - Мониторинг
   - Оптимизация
   - Готовность к Go

2. Интеграция с провайдерами
   - Тестирование API
   - Мониторинг
   - Обработка ошибок

### Бизнес риски
1. Ограничения провайдеров
   - Мониторинг лимитов
   - Планирование мощностей
   - Резервные планы

2. Масштабируемость
   - Мониторинг роста
   - План миграции
   - Оценка ограничений